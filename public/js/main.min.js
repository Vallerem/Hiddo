"use strict";function resize(){$(window).width()>740?$(".li-user-dropdown").addClass("flex-last"):$(".li-user-dropdown").removeClass("flex-last")}$(window).resize(resize),resize();var spotLat,spotLong,lati,longi,arrLength,searchedLength;void 0!==arrLength&&arrLength%2!=0&&$(".searched-spot").last().removeClass("col-md-6").addClass("col-md-12"),void 0!==searchedLength&&searchedLength%2!=0&&$(".searched-spot").last().removeClass("col-md-6").addClass("col-md-12"),$(document).ready(function(){var o=$(window).height(),e=$("#footer").height(),t=$("#footer").position().top+e;t<o&&$("#footer").css("margin-top",o-t+10+"px");var n=window.location.pathname;if($('.navbar-nav > li > a[href="'+n+'"]').parent().addClass("active"),$(".main input[type=text], .main input[type=password], #signup_form #username ,      #signup_form #mail, #signup_form #password").on("keypress",function(o){if(32==o.which)return!1}),$("#signup_form").submit(function(o){$("span.button-checkbox  :checkbox:checked").length<=0&&(o.preventDefault(),$("div .alert-danger").remove(),$(".avatar_img").prepend('<div class="alert alert-danger" role="alert"><strong>Hey, listen!</strong>  Please, select at least 1 interest.</div>'),$("#signup_form").unbind("submit",preventDefault))}),$("form.contact-form, form.signup_form").submit(function(){$(this).find(":submit").attr("disabled","disabled")}),$("main, footer").on("click",function(){$(".navbar-collapse").removeClass("show")}),$(".button-checkbox").each(function(){function o(){var o=n.is(":checked");t.data("state",o?"on":"off"),t.find(".state-icon").removeClass().addClass("state-icon "+s[t.data("state")].icon),o?t.removeClass("btn-default").addClass("btn-"+a+" active"):t.removeClass("btn-"+a+" active").addClass("btn-default")}var e=$(this),t=e.find("button"),n=e.find("input:checkbox"),a=t.data("color"),s={on:{icon:"fa fa-check-circle"},off:{icon:"fa fa-circle-thin"}};t.on("click",function(){n.prop("checked",!n.is(":checked")),n.triggerHandler("change"),o()}),n.on("change",function(){o()}),o(),0==t.find(".state-icon").length&&t.prepend('<i class="state-icon '+s[t.data("state")].icon+'"></i> ')}),$("#spot_form, #update-spot").submit(function(o){$("#spot-latitude").val()&&"undefined"===$("#spot-longitude").val()?(o.preventDefault(),$(".no-loc").remove(),$(".make-spot").prepend('<p class="alert alert-danger no-loc"> <strong>You need to select a location for your spot</strong></p>')):$(this).find(":submit").attr("disabled","disabled")}),$("#existing-location").click(function(o){$(".no-loc").remove(),$(".existing-loc").removeClass("hidden"),$("#google_map").addClass("hidden"),$(".alert-loc-saved").remove(),$("#save-existing-location").show()}),$("#save-existing-location").click(function(o){$(".no-loc").remove(),$("#spot-latitude").val(spotLat),$("#spot-longitude").val(spotLng),spotLat||void 0!==spotLng?($(".alert-no-loc, .alert-loc-saved").remove(),$(".existing-loc").prepend('<p class="alert alert-success alert-loc-saved">Spot location saved near: <strong>'+spotName+" </strong></p>")):($(".alert-no-loc").remove(),$(".existing-loc").prepend('<p class="alert alert-danger alert-no-loc"> <strong>You must select an existing location first</strong></p>'))}),$("#current-location").on("click",function(o){$(".alert-loc-saved").remove(),$("#save-existing-location").hide(),$(this).empty().prepend('<i class="fa fa-refresh fa-spin"></i> Searching...').prop("disabled",!0),$(".existing-loc").addClass("hidden"),$(".no-loc").remove(),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(o){var e={lat:o.coords.latitude,lng:o.coords.longitude};console.log("User position: ",e),$("#spot-latitude").val(e.lat),$("#spot-longitude").val(e.lng),$("#current-location").empty().prop("disabled",!1).prepend("Use current location"),$(".use-current-location").append('<p class="alert alert-success alert-loc-saved"><strong>Spot location saved</strong></p>'),$("#google_map").removeClass("hidden"),function(){var o={lat:e.lat,lng:e.lng},t=new google.maps.Map(document.getElementById("google_map"),{zoom:16,center:o,mapTypeId:"hybrid"});new google.maps.Marker({position:{lat:o.lat,lng:o.lng},map:t,label:{color:"white",fontWeight:"bold",text:"You are here"}})}()},function(){alert("Error in the geolocation service.")}):alert("Browser does not support geolocation.")}),$(".update-image").on("submit",function(o){o.preventDefault();var e=new FormData;e.append("userfile",$("#newImg")[0].files[0]);var t={oldImg:$("#oldImg").val(),newImg:e};$.ajax({url:"/avatar-img",data:t,type:"POST",processData:!1,contentType:!1,dataType:"json",cache:!1,success:function(o){console.log(o),$(body).append(o)},error:function(o){console.log("ERROR updating image")}})}),$("#update_user_form").on("click",function(o){$("#new-password").val().length>0&&$("#current-password").val().length<=0&&(o.preventDefault(),$(".alert-pas").remove(),$(".new-pas").append('<p style="margin-top: 5px;" class="alert-pas alert alert-warning">Enter your current password to update</p>'))}),spotLat&&void 0!==spotLong){var a;!function(){a=new google.maps.Map(document.getElementById("show-spot-map"),{center:{lat:spotLat,lng:spotLong},zoom:11,mapTypeId:"roadmap"});var o=new google.maps.Marker({position:{lat:spotLat,lng:spotLong},map:a}),e=new google.maps.InfoWindow({content:"<strong>"+locationName+"</strong>\n     - \n    <em>"+locationCountry+"</em> <br><br>\n    <strong>Latitude</strong>: "+spotLat+"<br>\n    <strong>Longitude</strong>: "+spotLong});google.maps.event.addListener(o,"click",function(o){e.open(a,this)})}()}if(lati&&void 0!==longi){!function(){var o;o=new google.maps.Map(document.getElementById("spot-loc"),{center:{lat:lati,lng:longi},zoom:11,mapTypeId:"roadmap"});var e=new google.maps.Marker({position:{lat:lati,lng:longi},map:o,animation:google.maps.Animation.DROP}),t=new google.maps.InfoWindow({content:"<strong>"+locationName+"</strong>\n     - \n    <em>"+locationCountry+"</em> <br><br>\n    <strong>Latitude</strong>: "+lati+"<br>\n    <strong>Longitude</strong>: "+longi});google.maps.event.addListener(e,"click",function(e){t.open(o,this)})}()}$(".btn-explore").on("click",function(){$.ajax({type:"GET",url:"/exploring",dataType:"json",success:function(o){o.forEach(function(o){$(".container-spots").append('<div class="col-12 col-sm-12 col-md-6 searched-spot" style="background: url('+o.mainImage+') no-repeat; float:left;background-size: cover;"><div class="search-darken"> </div><p class="search-title"> '+o.name+'  <br><span class="search-country"> '+o.country+' </span></p>\n    <p class=" hidden-sm-down search-intro">&ldquo; '+o.spotInfo.introduction+' &rdquo;</p>\n\n    <p><a class="btn calltoaction btn--search" href="/spot/'+o._id+'">Discover</a>\n    </p>\n  </div>')})},error:function(o){console.log("ERROR updating image")}})})});